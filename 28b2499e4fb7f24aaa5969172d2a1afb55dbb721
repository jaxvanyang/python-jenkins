{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "22ac5486_de7b9d03",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 1
      },
      "lineNbr": 0,
      "author": {
        "id": 2475
      },
      "writtenOn": "2023-03-16T20:09:27Z",
      "side": 1,
      "message": "From my comment on https://review.opendev.org/c/jjb/python-jenkins/+/865776\n\n\u003e Locally I can reproduce the failure it comes from v66.0.0 https://setuptools.pypa.io/en/latest/history.html#v66-0-0\n\u003e \n\u003e 15 Jan 2023\n\u003e    Breaking Changes\n\u003e \n\u003e #2497: Support for PEP 440 non-conforming versions has been removed. Environments containing packages with non-conforming versions may fail or the packages may not be recognized.\n\n",
      "revId": "28b2499e4fb7f24aaa5969172d2a1afb55dbb721",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "03a4256c_ca3a81f9",
        "filename": "jenkins/plugins.py",
        "patchSetId": 1
      },
      "lineNbr": 45,
      "author": {
        "id": 2475
      },
      "writtenOn": "2023-03-16T15:47:30Z",
      "side": 1,
      "message": "That should be:\n\n import packaging.version",
      "range": {
        "startLine": 45,
        "startChar": 0,
        "endLine": 45,
        "endChar": 16
      },
      "revId": "28b2499e4fb7f24aaa5969172d2a1afb55dbb721",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "63abd45c_8882f036",
        "filename": "jenkins/plugins.py",
        "patchSetId": 1
      },
      "lineNbr": 80,
      "author": {
        "id": 2475
      },
      "writtenOn": "2023-03-16T15:47:30Z",
      "side": 1,
      "message": "I have hit the issue previously when parsing a list of Jenkins plugins. Their version do not match whatever PEP defines a version and thus some versions might end up being invalid.\n\n import pkg_resources\n import packaging.version\n \n versions \u003d [\u00271.4.4\u0027, \u00271.5\u0027, \u00274.5.13-138.v4e7d9a_7b_a_e61\u0027]\n \n for v in versions:\n     print(\u0027Version\u0027, v, end\u003d\u0027 \u0027)\n     try:\n         pkg_resources.parse_version(v)\n         print(\u0027OK\u0027)\n         packaging.version.parse(v)\n         print(\u0027OK\u0027)\n     except Exception as e:\n         print(\u0027Exception\u0027, e)\n\nWhich gives:\n\n Version 1.4.4                                                                                                                                                                                 \n OK                                                                                                                                                                                            \n OK                                                                                                                                                                                            \n Version 1.5                                                                                                                                                                                   \n OK                                                                                                                                                                                            \n OK                                                                                                                                                                                            \n Version 4.5.13-138.v4e7d9a_7b_a_e61                                                                                                                                                           \n OK                                                                                                                                                                                            \n Exception Invalid version: \u00274.5.13-138.v4e7d9a_7b_a_e61\u0027",
      "range": {
        "startLine": 79,
        "startChar": 0,
        "endLine": 80,
        "endChar": 44
      },
      "revId": "28b2499e4fb7f24aaa5969172d2a1afb55dbb721",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2509d39c_6ee2dd71",
        "filename": "jenkins/plugins.py",
        "patchSetId": 1
      },
      "lineNbr": 80,
      "author": {
        "id": 2475
      },
      "writtenOn": "2023-03-17T10:41:02Z",
      "side": 1,
      "message": "After some digging `openstack/requirements` lists https://pypi.org/project/semantic-version/ which provides semantic versioning and supports invalid versions (via Version.coerce()). A demo:\n\n import semantic_version\n \n versions \u003d [\u00271.4.4\u0027, \u00271.5\u0027, \u00274.5.13-138.v4e7d9a_7b_a_e61\u0027]\n \n for v in versions:\n     print(\u0027Version\u0027, v, end\u003d\u0027 \u0027)\n     semver \u003d semantic_version.Version.coerce(v)\n     print(\u0027OK\u0027)\n     print(\", \".join([\n         \"%s: %s\" % (attr, getattr(semver, attr))\n         for attr in [\u0027major\u0027, \u0027minor\u0027, \u0027patch\u0027, \u0027prerelease\u0027]\n         ]))\n  \nYields:\n\n Version 1.4.4 OK\n major: 1, minor: 4, patch: 4, prerelease: ()\n Version 1.5 OK\n major: 1, minor: 5, patch: 0, prerelease: ()\n Version 4.5.13-138.v4e7d9a_7b_a_e61 OK \n major: 4, minor: 5, patch: 13, prerelease: (\u0027138\u0027, \u0027v4e7d9a-7b-a-e61\u0027)\n \nIt thus support an invalid \u00271.5\u0027 and convert to \u00271.5.0\u0027, same for the invalid long one.  Both styles are used by Jenkins plugins.\n\n\nBy using `semantic_version` as a module dependency, we relieve ourselves from the way stricter Python package versioning which is slightly different and have no interest in supporting \"invalid\" version (as shown by Setuptools 66 dropping it entirely).",
      "parentUuid": "63abd45c_8882f036",
      "range": {
        "startLine": 79,
        "startChar": 0,
        "endLine": 80,
        "endChar": 44
      },
      "revId": "28b2499e4fb7f24aaa5969172d2a1afb55dbb721",
      "serverId": "4a232e18-c5a9-48ee-94c0-e04e7cca6543"
    }
  ]
}